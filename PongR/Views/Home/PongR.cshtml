@{
    ViewBag.Title = "PongR";
}

@if (false) { 
        <script src="../../Scripts/jquery-1.8.0-vsdoc.js" type="text/javascript"></script>
}
<!-- Contains players' name and the score -->

<div id="header">
    <div class="player-info-container">
        <div id="player1-info" class="player-info">
            <ul>
                <li id="player1-name">Test name</li>
                <li id="player1-score" class="player-score">0</li>
            </ul>            
        </div>
    </div>
    <div id="vs"><div>VS</div></div>
    <div class="player-info-container">
        <div id="player2-info" class="player-info">
            <ul>
                <li id="player2-name">Test name 2</li>
                <li id="player2-score" class="player-score">1</li>
            </ul>
        </div>
    </div>
</div>

<!-- Contains the play field -->

<div id="fieldContainer">
    <div id="player1-field" class="field">
        <div id="player1-goal" class="player-goal"></div>
        <div id="player1-area" class="player-area">
            <div id="player1-bar" class="player-bar initial-position"></div>           
        </div>             
    </div>        
    <div id="player2-field" class="field">
        <div id="player2-goal" class="player-goal"></div>
        <div id="player2-area" class="player-area">
            <div id="player2-bar" class="player-bar initial-position"></div>           
        </div>  
    </div>
</div>

<div class="ball"></div>
<!-- Footer 
<div id="footer">

</div> -->

<!-- 
This script reference is important because navigating to /signalr/hubs will automatically generate the script. 
This should be done via an HttpModule automatically generated by SignalR on the server side 
https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs
If you navigate to signalr/hubs in your browser, you'll see a script that is dynamically generated based on the hubs declared
on the server. Each hub on the server will become a property on the client side $.connection, e.g. $.connection.myHub.
 -->
<script type="text/javascript" src="@Url.Content("/signalr/hubs")"></script>  
<script type="text/javascript" src="@Url.Content("~/Js/pongR.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Js/viewModel.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Js/logic.js")"></script>
<script type="text/javascript">
    
    var pongRHub;

    // Function invoked when the user has to wait for an opponent
    pongHub.waits = function() {
        // TODO: Use a lightbox to display a waiting message
    }

    pongHub.start = function() {
        // TODO: Populate all the view models and do the binding with knockout.
        // Set the timeouts to compute game state and for notifying bars position
        // Start to animate the ball
    }


    $(document).ready(function () {
        // Proxy creation
        pongRHub = $.connection.pongRHub;
        pongRHub.username = @Html.Raw(Json.Encode(Model));

        // Step 1: Start the connection        
        // Step 3: Join the system
        $.connection.hub.start()
                    .done(function () {
                        chatHub.joined();
                    });
                    
    });

</script>